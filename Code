import csv
import os

FILENAME = "students.csv"

# Function to add a student
def add_student():
    id = input("Enter Student ID: ")
    name = input("Enter Name: ")
    age = input("Enter Age: ")
    course = input("Enter Course: ")

    # Append student to CSV file
    with open(FILENAME, mode='a', newline='') as file:
        writer = csv.writer(file)
        writer.writerow([id, name, age, course])
    print("Student record added successfully!\n")

# Function to display all students
def display_students():
    if not os.path.exists(FILENAME):
        print("No records found.\n")
        return
    with open(FILENAME, mode='r') as file:
        reader = csv.reader(file)
        students = list(reader)
        if not students:
            print("No records found.\n")
            return
        print(f"{'ID':<5}{'Name':<20}{'Age':<5}{'Course':<15}")
        print("-"*45)
        for s in students:
            print(f"{s[0]:<5}{s[1]:<20}{s[2]:<5}{s[3]:<15}")

# Function to search a student by ID
def search_student():
    search_id = input("Enter Student ID to search: ")
    found = False
    if os.path.exists(FILENAME):
        with open(FILENAME, mode='r') as file:
            reader = csv.reader(file)
            for s in reader:
                if s[0] == search_id:
                    print("Student Found:\n")
                    print(f"{'ID':<5}{'Name':<20}{'Age':<5}{'Course':<15}")
                    print("-"*45)
                    print(f"{s[0]:<5}{s[1]:<20}{s[2]:<5}{s[3]:<15}")
                    found = True
                    break
    if not found:
        print(f"Student with ID {search_id} not found.\n")

# Function to update student details
def update_student():
    search_id = input("Enter Student ID to update: ")
    updated = False
    if os.path.exists(FILENAME):
        with open(FILENAME, mode='r') as file:
            students = list(csv.reader(file))
        for i, s in enumerate(students):
            if s[0] == search_id:
                print("Enter new details:")
                id = input("Enter Student ID: ")
                name = input("Enter Name: ")
                age = input("Enter Age: ")
                course = input("Enter Course: ")
                students[i] = [id, name, age, course]
                updated = True
                break
        if updated:
            with open(FILENAME, mode='w', newline='') as file:
                writer = csv.writer(file)
                writer.writerows(students)
            print("Student record updated successfully!\n")
        else:
            print(f"Student with ID {search_id} not found.\n")
    else:
        print("No records found.\n")

# Function to delete student
def delete_student():
    search_id = input("Enter Student ID to delete: ")
    deleted = False
    if os.path.exists(FILENAME):
        with open(FILENAME, mode='r') as file:
            students = list(csv.reader(file))
        new_students = [s for s in students if s[0] != search_id]
        if len(new_students) != len(students):
            with open(FILENAME, mode='w', newline='') as file:
                writer = csv.writer(file)
                writer.writerows(new_students)
            print("Student record deleted successfully!\n")
        else:
            print(f"Student with ID {search_id} not found.\n")
    else:
        print("No records found.\n")

# Main menu
def main():
    while True:
        print("\nStudent Record Management System")
        print("1. Add Student")
        print("2. Display Students")
        print("3. Search Student")
        print("4. Update Student")
        print("5. Delete Student")
        print("6. Exit")
        choice = input("Enter your choice: ")

        if choice == "1":
            add_student()
        elif choice == "2":
            display_students()
        elif choice == "3":
            search_student()
        elif choice == "4":
            update_student()
        elif choice == "5":
            delete_student()
        elif choice == "6":
            print("Exiting...")
            break
        else:
            print("Invalid choice! Try again.\n")

if __name__ == "__main__":
    main()
